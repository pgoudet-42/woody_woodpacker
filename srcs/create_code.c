#include "../include/woody.h"

unsigned char code[] = {  0x90,
                          0x90,
                          0x48, 0x31, 0xed,
                          0x48, 0x83, 0xec, 0x20,
                          0x66, 0xc7, 0x44, 0x24, 0x1d, 0x0f, 0x00,
                          0x48, 0x8b, 0x7c, 0x24, 0x1d,
                          0x48, 0x81, 0xe7, 0xff, 0x00, 0x00, 0x00,
                          0x48, 0xff, 0xc7,
                          0x48, 0x8b, 0x74, 0x24, 0x1d,
                          0x48, 0x81, 0xe6, 0xff, 0x00, 0x00, 0x00,
                          0x48, 0x8b, 0x3c, 0x3c,
                          0x48, 0x81, 0xe7, 0xff, 0x00, 0x00, 0x00,
                          0x48, 0x8b, 0x34, 0x34,
                          0x48, 0x81, 0xe6, 0xff, 0x00, 0x00, 0x00,
                          0x48, 0x31, 0xfe,
                          0x66, 0x83, 0x6c, 0x24, 0x1d, 0x01,
                          0x66, 0x83, 0x7c, 0x24, 0x1d, 0x01,
                          0x7f, 0xbd,
                          0xe9, 0x10, 0x50, 0x00, 0x00
                        };

unsigned char *get_code(size_t *size) {
    unsigned char *code_local;

    *size = 87;
    code_local = malloc(*size);
    if (!code_local)
        return (NULL);
    memcpy(code_local, code, *size);
    return (code_local);
}